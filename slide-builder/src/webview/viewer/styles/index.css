/**
 * Viewer webview styles.
 *
 * Story Reference: cv-2-1 Task 5.5
 * Architecture Reference: ADR-008 — CSS Custom Properties
 */

@import "../../shared/styles/theme.css";

/* =============================================================================
 * Root Layout
 * ============================================================================= */

.viewer-root {
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%;
  overflow: hidden;
  background: var(--bg);
  color: var(--fg);
}

/* =============================================================================
 * Loading State
 * ============================================================================= */

.viewer-loading {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  gap: var(--space-3);
}

.viewer-loading__spinner {
  width: 32px;
  height: 32px;
  border: 3px solid var(--border);
  border-top-color: var(--primary);
  border-radius: 50%;
  animation: viewer-spin 0.8s linear infinite;
}

@keyframes viewer-spin {
  to {
    transform: rotate(360deg);
  }
}

/* ae-1-3 AC-17: Spin animation for Loader2 spinner on Edit with AI button */
@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

.viewer-loading__text {
  font-size: 13px;
  color: var(--fg-secondary);
}

/* =============================================================================
 * Slide Renderer (Iframe)
 * ============================================================================= */

.slide-renderer {
  flex: 1;
  display: flex;
  flex-direction: column;
  min-height: 0;
}

.slide-renderer__iframe {
  flex: 1;
  width: 100%;
  border: none;
  background: var(--card);
}

/* Error state */
.slide-renderer__error {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  text-align: center;
  padding: var(--space-8) var(--space-4);
  gap: var(--space-2);
}

.slide-renderer__error-title {
  font-size: 14px;
  font-weight: 600;
  color: var(--fg);
}

.slide-renderer__error-hint {
  font-size: 13px;
  color: var(--fg-secondary);
  max-width: 320px;
}

/* =============================================================================
 * Empty State (AC-6)
 * ============================================================================= */

.viewer-empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  text-align: center;
  padding: var(--space-8) var(--space-4);
  gap: var(--space-3);
}

.viewer-empty-state__icon {
  color: var(--fg-faint);
}

.viewer-empty-state__title {
  font-size: 16px;
  font-weight: 600;
  color: var(--fg);
}

.viewer-empty-state__hint {
  font-size: 13px;
  color: var(--fg-secondary);
  max-width: 280px;
}

.viewer-empty-state__cta {
  display: inline-flex;
  align-items: center;
  gap: var(--space-1);
  margin-top: var(--space-2);
  padding: var(--space-2) var(--space-4);
  background: var(--primary);
  color: #fff;
  border: none;
  border-radius: var(--radius-sm);
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
}

.viewer-empty-state__cta:hover {
  background: var(--primary-hover);
}

.viewer-empty-state__cta:focus-visible {
  outline: 2px solid var(--primary);
  outline-offset: 2px;
}

/* =============================================================================
 * V2 Slide Display (innerHTML-based, no iframes)
 * v2-1-2 AC-4,5,6,7: Centered with dark backdrop, 16:9 aspect ratio, shadow
 * Architecture Reference: ADR-001 — innerHTML over iframes
 * ============================================================================= */

/* V2 Viewer tokens (dark backdrop) */
:root {
  color-scheme: dark;
  --viewer-bg: #1e1e1e;
  --viewer-surface: #2d2d2d;
  --viewer-text: #cccccc;
  --viewer-text-muted: #808080;
  --viewer-border: #3c3c3c;
  --viewer-hover: #3a3a3a;
  --viewer-toolbar: #333333;
}

.slide-display {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 0;
  min-width: 0;
  padding: var(--space-4);
  /* AC-6: Dark backdrop */
  background: var(--viewer-bg);
  overflow: hidden;
  position: relative;
}

/* Invisible sizer to measure available content area (inside padding) */
.slide-display__sizer {
  position: absolute;
  inset: var(--space-4);
  pointer-events: none;
}

/* Wrapper sized by JS — centered by parent flexbox */
.slide-display__wrapper {
  /* AC-7: Drop shadow for floating depth */
  box-shadow: 0 4px 24px rgba(0, 0, 0, 0.5);
  border-radius: var(--radius-xs);
  overflow: hidden;
  flex-shrink: 0;
  position: relative;
}

.slide-display__container {
  /* AC-5: Shadow DOM provides complete CSS isolation (story-css-isolation-1) */
  /* Note: contain:content removed - Shadow DOM is superior for isolation */
  /* Slide content background */
  background: #ffffff;
  /* Explicitly set dark color-scheme on the Shadow DOM host so it inherits into
     the shadow tree. Prevents fullscreen API transitions from disrupting the
     inherited color-scheme and causing slide content to render with light UA defaults. */
  color-scheme: dark;
  /* Width/height/transform set via inline styles by useSlideScale hook */
}

/* V2 Viewer main content area */
.viewer-main {
  flex: 1;
  display: flex;
  flex-direction: column;
  min-height: 0;
  min-width: 0; /* Prevent flex blowout when content is wide */
  background: var(--viewer-bg);
  overflow: hidden;
}

/* V2 Viewer footer */
.viewer-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-2) var(--space-4);
  background: var(--viewer-surface);
  border-top: 1px solid var(--viewer-border);
  font-size: 12px;
  color: var(--viewer-text);
}

.viewer-deck-name {
  font-weight: 500;
}

.viewer-slide-counter {
  font-variant-numeric: tabular-nums;
}

/* V2 Error state */
.viewer-error {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  text-align: center;
  padding: var(--space-8) var(--space-4);
  gap: var(--space-3);
  background: var(--viewer-bg);
  color: var(--error);
}

.viewer-error h2 {
  font-size: 18px;
  font-weight: 600;
  color: #ffffff;
}

.viewer-error p {
  font-size: 13px;
  color: var(--viewer-text);
  max-width: 400px;
}

/* V2 Empty state hint (temporary) */
.viewer-empty-hint {
  font-size: 11px;
  color: var(--fg-faint);
  margin-top: var(--space-2);
}

/* V2 No slide state */
.viewer-no-slide {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  color: var(--viewer-text);
}

/* =============================================================================
 * v2-1-3: SlideCounter Component
 * AC7: Shows "N / Total" in 14px font, weight 600, --viewer-text color
 * AC8: Click opens jump-to-slide input
 * ============================================================================= */

.slide-counter {
  display: inline-flex;
  align-items: center;
  gap: 0;
  padding: var(--space-1) var(--space-2);
  font-size: 14px;
  font-weight: 600;
  font-variant-numeric: tabular-nums;
  color: var(--viewer-text);
  background: transparent;
  border: 1px solid transparent;
  border-radius: var(--radius-xs);
  cursor: pointer;
  transition: background-color 0.15s, border-color 0.15s;
}

.slide-counter:hover {
  background: var(--viewer-hover);
  border-color: var(--viewer-border);
}

.slide-counter:focus-visible {
  outline: 2px solid var(--primary);
  outline-offset: 2px;
}

.slide-counter--input-mode {
  cursor: default;
}

.slide-counter__input {
  width: 40px;
  padding: 2px 4px;
  font-size: 14px;
  font-weight: 600;
  font-variant-numeric: tabular-nums;
  color: var(--viewer-text);
  background: var(--viewer-bg);
  border: 1px solid var(--viewer-border);
  border-radius: var(--radius-xs);
  text-align: center;
}

.slide-counter__input:focus {
  outline: 2px solid var(--primary);
  outline-offset: 1px;
  border-color: var(--primary);
}

.slide-counter__separator {
  opacity: 0.7;
}

.slide-counter__total {
  opacity: 0.7;
}

/* =============================================================================
 * v2-1-3: NavigationArrows Component
 * AC9: Ghost icon buttons on main content area
 * ============================================================================= */

.navigation-arrows {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 var(--space-2);
}

.navigation-arrows__button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 48px;
  height: 48px;
  padding: 0;
  background: transparent;
  border: none;
  border-radius: var(--radius-sm);
  color: var(--viewer-text);
  cursor: pointer;
  pointer-events: auto;
  opacity: 0.6;
  transition: opacity 0.15s, background-color 0.15s;
}

.navigation-arrows__button:hover {
  opacity: 1;
  background: var(--viewer-hover);
}

.navigation-arrows__button:focus-visible {
  outline: 2px solid var(--primary);
  outline-offset: 2px;
  opacity: 1;
}

.navigation-arrows__button:active {
  opacity: 1;
  background: var(--viewer-border);
}

.navigation-arrows__icon {
  flex-shrink: 0;
}

/* Position navigation arrows relative to viewer-main */
.viewer-main {
  position: relative;
}

/* =============================================================================
 * v2-1-4: Viewer Body Layout (Sidebar + Main)
 * ============================================================================= */

.viewer-body {
  flex: 1;
  display: flex;
  flex-direction: row;
  min-height: 0;
  min-width: 0;
  overflow: hidden;
}

/* =============================================================================
 * v2-1-4: Thumbnail Sidebar
 * AC1: 180px width sidebar with miniature previews
 * AC4: Auto-scroll to keep active thumbnail visible
 * ============================================================================= */

.thumbnail-sidebar {
  width: 180px;
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  background: var(--viewer-surface);
  border-right: 1px solid var(--viewer-border);
}

.thumbnail-sidebar__scroll {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  padding: var(--space-2);
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
}

/* Custom scrollbar styling for sidebar */
.thumbnail-sidebar__scroll::-webkit-scrollbar {
  width: 6px;
}

.thumbnail-sidebar__scroll::-webkit-scrollbar-track {
  background: transparent;
}

.thumbnail-sidebar__scroll::-webkit-scrollbar-thumb {
  background: var(--viewer-border);
  border-radius: 3px;
}

.thumbnail-sidebar__scroll::-webkit-scrollbar-thumb:hover {
  background: var(--viewer-hover);
}

/* =============================================================================
 * v2-1-4: Thumbnail Card
 * AC2: Click to navigate in <50ms
 * AC3: Active state with blue border (#3a61ff) and glow
 * AC5: Lazy loading via IntersectionObserver
 * AC6: Slide number label below thumbnail
 * ============================================================================= */

.thumbnail-card {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-1);
  padding: var(--space-1);
  background: transparent;
  border: 2px solid transparent;
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: border-color 0.15s, box-shadow 0.15s, background-color 0.15s;
  width: 100%;
}

.thumbnail-card:hover {
  background: var(--viewer-hover);
  border-color: var(--viewer-border);
}

.thumbnail-card:focus-visible {
  outline: 2px solid var(--primary);
  outline-offset: 2px;
}

/* AC3: Active thumbnail - blue border and glow */
.thumbnail-card--active {
  border-color: #3a61ff;
  box-shadow: 0 0 8px rgba(58, 97, 255, 0.4);
  background: rgba(58, 97, 255, 0.1);
}

.thumbnail-card--active:hover {
  border-color: #3a61ff;
  background: rgba(58, 97, 255, 0.15);
}

/* Thumbnail wrapper - maintains 16:9 aspect ratio */
.thumbnail-card__wrapper {
  position: relative;
  width: 100%;
  /* 16:9 aspect ratio for thumbnail container */
  aspect-ratio: 16 / 9;
  overflow: hidden;
  border-radius: var(--radius-xs);
  background: #ffffff;
  /* cv-bugfix-thumbnail-rendering AC-1: Fallback clipping to guarantee no visual overflow */
  clip-path: inset(0);
}

/* Preview container - scale transform for slide preview */
.thumbnail-card__preview {
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
  /* cv-bugfix-thumbnail-rendering AC-1,AC-3: Upgraded from contain:content to contain:strict
     for full CSS isolation — prevents slide styles from leaking into viewer UI */
  contain: strict;
  /* Width/height/transform set via inline styles by useSlideScale hook */
}

/* Placeholder for lazy loading */
.thumbnail-card__placeholder {
  position: absolute;
  inset: 0;
  background: var(--viewer-border);
  display: flex;
  align-items: center;
  justify-content: center;
}

/* AC6: Slide number label */
.thumbnail-card__number {
  font-size: 11px;
  font-weight: 500;
  font-variant-numeric: tabular-nums;
  color: var(--viewer-text);
  opacity: 0.8;
}

.thumbnail-card--active .thumbnail-card__number {
  color: #3a61ff;
  opacity: 1;
}

/* =============================================================================
 * v2-2-1: Viewer Toolbar
 * AC-1: 44px height, full width, dark background (--viewer-toolbar: #333333)
 * AC-2: Left section with sidebar toggle + deck name
 * AC-3: Center section with navigation controls
 * AC-4: Right section with mode toggles and actions
 * AC-10: Ghost buttons with aria-labels
 * ============================================================================= */

.viewer-toolbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  height: 44px;
  flex-shrink: 0;
  padding: 0 var(--space-2);
  background: var(--viewer-toolbar);
  border-bottom: 1px solid var(--viewer-border);
}

.viewer-toolbar__left {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  min-width: 0;
  flex-shrink: 1;
}

.viewer-toolbar__center {
  display: flex;
  align-items: center;
  gap: var(--space-1);
}

.viewer-toolbar__right {
  display: flex;
  align-items: center;
  gap: var(--space-1);
}

/* Ghost button style for toolbar */
.viewer-toolbar__button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  padding: 0;
  background: transparent;
  border: none;
  border-radius: var(--radius-sm);
  color: var(--viewer-text);
  cursor: pointer;
  transition: background-color 0.15s, opacity 0.15s;
}

.viewer-toolbar__button:hover:not(:disabled) {
  background: var(--viewer-hover);
}

.viewer-toolbar__button:focus-visible {
  outline: 2px solid var(--primary);
  outline-offset: 2px;
}

.viewer-toolbar__button:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

/* Deck name in toolbar */
.viewer-toolbar__deck-name {
  font-size: 14px;
  font-weight: 500;
  color: var(--viewer-text);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 200px;
}

/* story-1.1: Build badge — subtle pill next to hammer icon */
.viewer-toolbar__build-badge {
  display: inline-flex;
  align-items: center;
  font-size: 10px;
  font-weight: 600;
  font-variant-numeric: tabular-nums;
  color: var(--viewer-text);
  background: var(--viewer-border);
  padding: 2px 6px;
  border-radius: 8px;
  line-height: 1;
  white-space: nowrap;
  margin-left: -2px;
}

/* Separator between button groups */
.viewer-toolbar__separator {
  width: 1px;
  height: 20px;
  background: var(--viewer-border);
  margin: 0 var(--space-1);
}

/* =============================================================================
 * v2-2-1: Status Bar
 * 24px height strip at bottom
 * ============================================================================= */

.viewer-status-bar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  height: 24px;
  flex-shrink: 0;
  padding: 0 var(--space-3);
  background: var(--viewer-surface);
  border-top: 1px solid var(--viewer-border);
  font-size: 11px;
  color: var(--viewer-text-muted);
}

.viewer-status-bar__left,
.viewer-status-bar__center,
.viewer-status-bar__right {
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.viewer-status-bar__build-step {
  font-variant-numeric: tabular-nums;
}

.viewer-status-bar__mode {
  color: var(--primary);
  font-weight: 500;
}

.viewer-status-bar__hint {
  opacity: 0.7;
}

/* =============================================================================
 * v2-2-1: Sidebar Collapse/Expand
 * AC-5,6: 200ms transition, collapse to 0px
 * AC-9: Responsive behavior
 * ============================================================================= */

.thumbnail-sidebar {
  transition: width 200ms ease, opacity 200ms ease;
}

.thumbnail-sidebar--collapsed {
  width: 0;
  opacity: 0;
  overflow: hidden;
  border-right: none;
}

/* =============================================================================
 * v2-2-1: Responsive Behavior
 * AC-9: At <600px, sidebar collapsed by default, deck name truncates
 * ============================================================================= */

@media (max-width: 600px) {
  .viewer-toolbar__deck-name {
    max-width: 100px;
  }

  /* Hide separator and low-priority buttons on narrow viewports */
  .viewer-toolbar__separator {
    display: none;
  }

  /* Reduce button size on narrow */
  .viewer-toolbar__button {
    width: 28px;
    height: 28px;
  }
}

/* =============================================================================
 * v2-2-2: Fullscreen Presentation Mode
 * AC-3: Hide toolbar, sidebar, status bar in fullscreen
 * AC-4: Slide fills viewport maintaining 16:9 aspect ratio
 * AC-5,6: Navigation controls with fade visibility
 * AC-9: prefers-reduced-motion disables transitions
 * ============================================================================= */

/* Fullscreen wrapper - covers entire viewport */
.fullscreen-wrapper {
  position: fixed;
  inset: 0;
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--viewer-bg);
  opacity: 1;
  transition: opacity 200ms ease;
}

/* Fullscreen content container */
.fullscreen-wrapper__content {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Inactive fullscreen wrapper - transparent pass-through when not fullscreen.
 * This maintains DOM structure stability to prevent Shadow DOM content loss
 * when toggling fullscreen (story-css-isolation-1). */
.fullscreen-wrapper--inactive {
  display: contents;
}

.fullscreen-wrapper__content--inactive {
  display: contents;
}

/* Fullscreen color scheme: prevent browser light-mode override leaking into Shadow DOM */
html:fullscreen,
html:-webkit-full-screen {
  color-scheme: dark;
  background: var(--viewer-bg);
}

::backdrop {
  background: var(--viewer-bg);
}

/* Override slide display styles in fullscreen for full viewport fill */
.fullscreen-wrapper .slide-display {
  padding: 0;
  width: 100%;
  height: 100%;
}

/* Sizer fills entire fullscreen area (no padding offset) */
.fullscreen-wrapper .slide-display__sizer {
  inset: 0;
}

.fullscreen-wrapper .slide-display__wrapper {
  box-shadow: none;
  border-radius: 0;
}

/* =============================================================================
 * Fullscreen Controls - Navigation overlay
 * ============================================================================= */

.fullscreen-controls {
  position: fixed;
  inset: 0;
  z-index: 10000;
  pointer-events: none;
  opacity: 0;
  transition: opacity 200ms ease;
}

.fullscreen-controls--visible {
  opacity: 1;
}

/* Navigation buttons */
.fullscreen-controls__button {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  display: flex;
  align-items: center;
  justify-content: center;
  width: 64px;
  height: 96px;
  padding: 0;
  background: rgba(0, 0, 0, 0.5);
  border: none;
  border-radius: var(--radius-sm);
  color: #ffffff;
  cursor: pointer;
  pointer-events: auto;
  transition: background-color 200ms ease, opacity 200ms ease;
}

.fullscreen-controls__button:hover {
  background: rgba(0, 0, 0, 0.7);
}

.fullscreen-controls__button:focus-visible {
  outline: 2px solid var(--primary);
  outline-offset: 2px;
}

.fullscreen-controls__button--prev {
  left: var(--space-4);
}

.fullscreen-controls__button--next {
  right: var(--space-4);
}

/* Slide counter - bottom center */
.fullscreen-controls__counter {
  position: absolute;
  bottom: var(--space-6);
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  align-items: center;
  gap: 0;
  padding: var(--space-2) var(--space-4);
  background: rgba(0, 0, 0, 0.6);
  border-radius: var(--radius-sm);
  font-size: 18px;
  font-weight: 600;
  font-variant-numeric: tabular-nums;
  color: #ffffff;
  pointer-events: auto;
}

.fullscreen-controls__separator {
  opacity: 0.7;
}

.fullscreen-controls__total {
  opacity: 0.7;
}

/* =============================================================================
 * v3-1-2: Fullscreen Edit Toolbar
 * Minimal toolbar for fullscreen edit mode with save status and ESC hint
 * ============================================================================= */

.fullscreen-edit-toolbar {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 10001;
  display: flex;
  align-items: center;
  justify-content: space-between;
  height: 36px;
  padding: 0 16px;
  background: rgba(0, 0, 0, 0.7);
  backdrop-filter: blur(8px);
  color: rgba(255, 255, 255, 0.9);
  font-size: 13px;
}

.fullscreen-edit-toolbar__status {
  display: flex;
  align-items: center;
  gap: 8px;
}

.fullscreen-edit-toolbar__save {
  font-size: 12px;
}

.fullscreen-edit-toolbar__save--idle {
  color: rgba(255, 255, 255, 0.6);
}

.fullscreen-edit-toolbar__save--saving {
  color: #facc15;
}

.fullscreen-edit-toolbar__save--saved {
  color: #4ade80;
}

.fullscreen-edit-toolbar__save--error {
  color: #f87171;
}

.fullscreen-edit-toolbar__hint {
  font-size: 12px;
  color: rgba(255, 255, 255, 0.5);
}

.fullscreen-edit-toolbar__hint kbd {
  display: inline-block;
  padding: 1px 5px;
  border: 1px solid rgba(255, 255, 255, 0.3);
  border-radius: 3px;
  font-family: inherit;
  font-size: 11px;
  color: rgba(255, 255, 255, 0.7);
}

/* =============================================================================
 * v2-2-2 AC-9: prefers-reduced-motion
 * Disable all transitions for users who prefer reduced motion
 * ============================================================================= */

@media (prefers-reduced-motion: reduce) {
  .fullscreen-wrapper,
  .fullscreen-controls,
  .fullscreen-controls__button {
    transition: none;
  }
}

/* =============================================================================
 * v2-2-3: Build Animation Playback
 * AC-1: Elements hidden with .animation-hidden on slide load
 * AC-3: Fade-in transition (300ms) when revealed
 * AC-11: prefers-reduced-motion disables transitions
 * ============================================================================= */

/* Applied to grouped elements on slide load - hide until revealed */
.animation-hidden {
  opacity: 0 !important;
  visibility: hidden !important;
}

/* Applied when group is revealed - fade in with transition */
.animation-visible {
  opacity: 1 !important;
  visibility: visible !important;
  transition: opacity 0.3s ease, visibility 0.3s ease;
}

/* Instant reveal (S key skip-all) - no transition */
.animation-instant {
  transition: none !important;
}

/* v2-2-3 AC-11: prefers-reduced-motion disables animation transitions */
@media (prefers-reduced-motion: reduce) {
  .animation-visible {
    transition: none !important;
  }
}

/* =============================================================================
 * v2-2-3: BuildStepIndicator Component
 * AC-2,4,9,10: "Build: N / Total" display with step dots
 * ============================================================================= */

.build-step-indicator {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  font-size: 11px;
  font-variant-numeric: tabular-nums;
  color: var(--viewer-text);
}

.build-step-indicator__text {
  font-weight: 500;
}

.build-step-indicator__dots {
  display: flex;
  align-items: center;
  gap: 4px;
}

.build-step-indicator__dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: var(--viewer-border);
  transition: background-color 0.15s ease;
}

.build-step-indicator__dot--filled {
  background: var(--primary);
}

/* Fullscreen build indicator - positioned in overlay */
.fullscreen-controls__build-indicator {
  position: absolute;
  bottom: var(--space-6);
  left: var(--space-6);
  display: flex;
  align-items: center;
  gap: var(--space-2);
  padding: var(--space-2) var(--space-3);
  background: rgba(0, 0, 0, 0.6);
  border-radius: var(--radius-sm);
  font-size: 14px;
  font-weight: 500;
  font-variant-numeric: tabular-nums;
  color: #ffffff;
  pointer-events: none;
}

.fullscreen-controls__build-dots {
  display: flex;
  align-items: center;
  gap: 4px;
}

.fullscreen-controls__build-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.3);
}

.fullscreen-controls__build-dot--filled {
  background: #ffffff;
}

/* =============================================================================
 * v2-2-1: Build Progress Overlay
 * Shows during build operations with progress bar and per-slide status.
 * ============================================================================= */

.build-overlay {
  position: fixed;
  inset: 0;
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(0, 0, 0, 0.8);
  backdrop-filter: blur(4px);
}

.build-overlay__content {
  width: 100%;
  max-width: 480px;
  max-height: 80vh;
  display: flex;
  flex-direction: column;
  background: var(--viewer-bg);
  border: 1px solid var(--viewer-border);
  border-radius: var(--radius-md);
  overflow: hidden;
}

/* Header */
.build-overlay__header {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
  padding: var(--space-4);
  border-bottom: 1px solid var(--viewer-border);
}

.build-overlay__title {
  font-size: 16px;
  font-weight: 600;
  color: var(--viewer-text);
  margin: 0;
}

.build-overlay__deck-name {
  font-size: 13px;
  color: var(--viewer-text);
  opacity: 0.7;
}

/* Progress Bar */
.build-overlay__bar-container {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  padding: var(--space-3) var(--space-4);
  background: var(--viewer-toolbar);
}

.build-overlay__bar {
  flex: 1;
  height: 8px;
  background: var(--viewer-border);
  border-radius: 4px;
  overflow: hidden;
}

.build-overlay__bar-fill {
  height: 100%;
  background: var(--primary);
  border-radius: 4px;
  transition: width 0.3s ease;
}

.build-overlay__bar-label {
  font-size: 12px;
  font-weight: 500;
  font-variant-numeric: tabular-nums;
  color: var(--viewer-text);
  white-space: nowrap;
}

/* Slides List */
.build-overlay__slides {
  flex: 1;
  overflow-y: auto;
  padding: var(--space-2);
}

/* Individual Slide Row */
.build-overlay__slide {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  padding: var(--space-2) var(--space-3);
  border-radius: var(--radius-sm);
  transition: background-color 0.15s ease;
}

.build-overlay__slide--building {
  background: rgba(58, 97, 255, 0.1);
  border-left: 3px solid var(--primary);
  padding-left: calc(var(--space-3) - 3px);
}

.build-overlay__slide-status {
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  height: 20px;
}

.build-overlay__slide-info {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 2px;
  min-width: 0;
}

.build-overlay__slide-number {
  font-size: 12px;
  font-weight: 500;
  color: var(--viewer-text);
}

.build-overlay__slide-name {
  font-size: 11px;
  color: var(--viewer-text);
  opacity: 0.7;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.build-overlay__slide-error {
  font-size: 11px;
  color: #ff6b6b;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Status Icons */
.build-overlay__status-icon {
  flex-shrink: 0;
}

.build-overlay__status-icon--built {
  color: #4caf50;
}

.build-overlay__status-icon--building {
  color: var(--primary);
  animation: build-spin 1s linear infinite;
}

.build-overlay__status-icon--error {
  color: #ff6b6b;
}

.build-overlay__status-icon--pending {
  color: var(--viewer-text);
  opacity: 0.4;
}

@keyframes build-spin {
  to {
    transform: rotate(360deg);
  }
}

/* Cancel Button */
.build-overlay__cancel {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-1);
  margin: var(--space-3) var(--space-4);
  padding: var(--space-2) var(--space-3);
  font-size: 13px;
  font-weight: 500;
  color: var(--viewer-text);
  background: transparent;
  border: 1px solid var(--viewer-border);
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: all 0.15s ease;
}

.build-overlay__cancel:hover {
  background: rgba(255, 255, 255, 0.05);
  border-color: var(--viewer-text);
}

/* Complete Banner */
.build-overlay__complete {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-2);
  padding: var(--space-4);
  text-align: center;
  background: rgba(76, 175, 80, 0.1);
  border-bottom: 1px solid var(--viewer-border);
}

.build-overlay__complete-icon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 48px;
  height: 48px;
  background: #4caf50;
  border-radius: 50%;
  color: #ffffff;
}

.build-overlay__complete-title {
  font-size: 16px;
  font-weight: 600;
  color: var(--viewer-text);
  margin: 0;
}

.build-overlay__complete-hint {
  font-size: 13px;
  color: var(--viewer-text);
  opacity: 0.7;
  margin: 0;
}

/* Cancelled Banner */
.build-overlay__cancelled {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  padding: var(--space-3) var(--space-4);
  background: rgba(255, 107, 107, 0.1);
  border-bottom: 1px solid var(--viewer-border);
}

.build-overlay__cancelled-icon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  background: rgba(255, 107, 107, 0.2);
  border-radius: 50%;
  color: #ff6b6b;
  flex-shrink: 0;
}

.build-overlay__cancelled-text {
  font-size: 13px;
  color: var(--viewer-text);
  flex: 1;
}

/* Action Buttons */
.build-overlay__action {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-1);
  padding: var(--space-2) var(--space-3);
  font-size: 13px;
  font-weight: 500;
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: all 0.15s ease;
}

.build-overlay__action--primary {
  background: var(--primary);
  color: #ffffff;
  border: none;
}

.build-overlay__action--primary:hover {
  background: var(--primary-hover);
}

.build-overlay__action--secondary {
  background: transparent;
  color: var(--viewer-text);
  border: 1px solid var(--viewer-border);
}

.build-overlay__action--secondary:hover {
  background: rgba(255, 255, 255, 0.05);
  border-color: var(--viewer-text);
}

/* ==========================================================================
   Live Edit Mode (v2-3-1)
   ========================================================================== */

/* AC-3.1.2: Hover underline on editable text elements */
.editable-hover {
  text-decoration: underline dashed;
  text-decoration-color: rgba(59, 130, 246, 0.5);
  cursor: text;
}

/* AC-3.1.3: Active editing border */
.editable-active {
  outline: 2px solid #3a61ff;
  outline-offset: 2px;
  cursor: text;
}

/* Status bar save status colors */
.save-status-saving {
  color: var(--viewer-text-secondary, #888);
}

.save-status-saved {
  color: #22c55e;
}

.save-status-error {
  color: #ef4444;
}

/* =============================================================================
 * v2-5-1: Export Menu Dropdown
 * Radix DropdownMenu styled to match viewer toolbar dark theme.
 * ============================================================================= */

.export-menu {
  background: var(--viewer-toolbar, #333);
  border: 1px solid var(--viewer-border, #3c3c3c);
  border-radius: 6px;
  padding: 4px;
  min-width: 200px;
  z-index: 100;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
  animation: export-menu-fade-in 0.12s ease-out;
}

@keyframes export-menu-fade-in {
  from { opacity: 0; transform: translateY(-4px); }
  to { opacity: 1; transform: translateY(0); }
}

.export-menu__item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  font-size: 13px;
  color: var(--viewer-text, #e0e0e0);
  border-radius: 4px;
  cursor: pointer;
  outline: none;
  user-select: none;
}

.export-menu__item:hover,
.export-menu__item[data-highlighted] {
  background: var(--viewer-hover, #3a3a3a);
}

.export-menu__item[data-disabled] {
  opacity: 0.4;
  cursor: not-allowed;
}

.export-menu__icon {
  flex-shrink: 0;
  opacity: 0.7;
}

.export-menu__separator {
  height: 1px;
  background: var(--viewer-border, #3c3c3c);
  margin: 4px 0;
}

/* Story 1.2: PDF quality preset submenu styles */
.export-menu__sub-trigger {
  justify-content: flex-start;
}

.export-menu__sub-trigger[data-state="open"] {
  background: var(--viewer-hover, #3a3a3a);
}

.export-menu__chevron {
  margin-left: auto;
  opacity: 0.5;
  flex-shrink: 0;
}

.export-menu__sub-content {
  min-width: 220px;
}


.export-progress-indicator {
  font-size: 12px;
  color: var(--primary, #3a61ff);
}

/* Toolbar edit button amber highlight when edit mode active */
.viewer-toolbar__button--edit-active {
  color: #f59e0b !important;
  background: rgba(245, 158, 11, 0.15);
}

/* Respect reduced motion for edit transitions */
@media (prefers-reduced-motion: reduce) {
  .editable-hover,
  .editable-active {
    transition: none;
  }
}

/* Screen reader only text */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* =============================================================================
 * v2-4-1: Drag-and-Drop Reordering
 * AC-1: Thumbnail lifts with shadow during drag
 * AC-2: Drop zone indicator appears at valid positions
 * ============================================================================= */

/* Dragging state - original position shows faded placeholder */
.thumbnail-card--dragging {
  opacity: 0.5;
  border-color: var(--viewer-border);
  background: var(--viewer-hover);
}

/* DragOverlay - lifted thumbnail during drag */
.thumbnail-card--overlay {
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4), 0 2px 8px rgba(0, 0, 0, 0.3);
  border-color: var(--primary);
  background: var(--viewer-surface);
  transform: scale(1.05);
  cursor: grabbing;
}

.thumbnail-card--overlay .thumbnail-card__wrapper {
  overflow: hidden;
}

/* cv-bugfix-thumbnail-rendering AC-5: Removed hardcoded scale(0.08).
   Width/height/transform/transformOrigin are now set via dynamic inline styles
   in ThumbnailSidebar.tsx based on actual sidebar dimensions. */
.thumbnail-card--overlay .thumbnail-card__preview--overlay {
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
  contain: strict;
  /* Width/height/transform set via inline styles */
}

/* Grab cursor when reorder is enabled */
.thumbnail-card[style*="cursor"] {
  cursor: grab;
}

.thumbnail-card:active {
  cursor: grabbing;
}

/* Disable grab cursor when reorder is disabled */
.thumbnail-card[disabled] {
  cursor: default;
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce) {
  .thumbnail-card--overlay {
    transform: none;
    transition: none;
  }
}

/* =============================================================================
 * v2-4-2: Animation Builder Mode
 * AC-2: Element overlays with dashed blue borders
 * AC-3: Selected state with solid border and checkmark
 * AC-5: Group badges on elements
 * AC-6: Empty state message
 * AC-10: Keyboard focus indicators
 * ============================================================================= */

.animation-builder {
  position: fixed;
  inset: 0;
  z-index: 100;
  pointer-events: none;
  display: flex;
}

/* Overlay container - allows click-through except on overlays */
.animation-builder__overlays {
  flex: 1;
  position: relative;
}

/* Side panel for controls */
.animation-builder__panel {
  position: fixed;
  right: 0;
  top: 44px; /* Below toolbar */
  bottom: 24px; /* Above status bar */
  width: 240px;
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
  padding: var(--space-3);
  background: var(--viewer-surface);
  border-left: 1px solid var(--viewer-border);
  pointer-events: auto;
  overflow-y: auto;
}

.animation-builder__panel-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding-bottom: var(--space-2);
  border-bottom: 1px solid var(--viewer-border);
}

.animation-builder__panel-title {
  font-size: 14px;
  font-weight: 600;
  color: var(--viewer-text);
  margin: 0;
}

.animation-builder__selection-count {
  font-size: 12px;
  color: var(--primary);
  font-weight: 500;
}

/* Create Group button */
.animation-builder__create-button {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-2);
  width: 100%;
  padding: var(--space-2) var(--space-3);
  font-size: 13px;
  font-weight: 500;
  color: #ffffff;
  background: var(--primary);
  border: none;
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: background-color 0.15s ease, opacity 0.15s ease;
}

.animation-builder__create-button:hover:not(:disabled) {
  background: var(--primary-hover);
}

.animation-builder__create-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.animation-builder__create-button:focus-visible {
  outline: 2px solid var(--primary);
  outline-offset: 2px;
}

/* Groups list */
.animation-builder__groups {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
}

.animation-builder__groups-title {
  font-size: 12px;
  font-weight: 600;
  color: var(--viewer-text);
  margin: 0;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  opacity: 0.8;
}

.animation-builder__groups-list {
  list-style: none;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.animation-builder__group-item {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  padding: var(--space-2);
  background: var(--viewer-hover);
  border-radius: var(--radius-xs);
}

.animation-builder__group-badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 24px;
  height: 20px;
  padding: 0 var(--space-1);
  font-size: 11px;
  font-weight: 600;
  color: #ffffff;
  background: var(--primary);
  border-radius: var(--radius-xs);
}

.animation-builder__group-count {
  font-size: 12px;
  color: var(--viewer-text);
  opacity: 0.8;
}

/* Keyboard hint */
.animation-builder__hint {
  font-size: 11px;
  color: var(--viewer-text-muted);
  line-height: 1.5;
  margin-top: auto;
}

.animation-builder__hint kbd {
  display: inline-block;
  padding: 2px 6px;
  font-size: 10px;
  font-family: inherit;
  background: var(--viewer-bg);
  border: 1px solid var(--viewer-border);
  border-radius: var(--radius-xs);
  margin: 0 2px;
}

/* Empty state */
.animation-builder--empty {
  display: flex;
  align-items: center;
  justify-content: center;
}

.animation-builder__empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: var(--space-8);
  pointer-events: auto;
}

.animation-builder__empty-message {
  font-size: 14px;
  color: var(--viewer-text-muted);
  margin: 0;
}

/* =============================================================================
 * v2-4-2: Element Overlay
 * Visual overlay positioned over each selectable element
 * ============================================================================= */

.element-overlay {
  box-sizing: border-box;
  border: 2px dashed #3a61ff;
  background: rgba(58, 97, 255, 0.1);
  border-radius: var(--radius-xs);
  cursor: pointer;
  transition: border-color 0.15s ease, background-color 0.15s ease, box-shadow 0.15s ease;
  z-index: 101;
}

.element-overlay:hover {
  background: rgba(58, 97, 255, 0.2);
}

.element-overlay:focus {
  outline: none;
}

/* Selected state - solid border + checkmark */
.element-overlay--selected {
  border-style: solid;
  border-color: #3a61ff;
  background: rgba(58, 97, 255, 0.25);
}

/* Focused state - additional ring for keyboard nav */
.element-overlay--focused {
  box-shadow: 0 0 0 3px rgba(58, 97, 255, 0.5);
}

/* Grouped state - show badge color based on group */
.element-overlay--grouped {
  background: rgba(58, 97, 255, 0.15);
}

/* Checkmark icon (top-right corner) */
.element-overlay__checkmark {
  position: absolute;
  top: -8px;
  right: -8px;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  height: 20px;
  background: #3a61ff;
  color: #ffffff;
  border-radius: 50%;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

/* Group badge (bottom-left corner) */
.element-overlay__badge {
  position: absolute;
  bottom: -6px;
  left: -6px;
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 24px;
  height: 18px;
  padding: 0 4px;
  font-size: 10px;
  font-weight: 700;
  color: #ffffff;
  background: #3a61ff;
  border-radius: 9px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

/* Tooltip (shown on hover) */
.element-overlay__tooltip {
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  padding: 4px 8px;
  font-size: 11px;
  font-weight: 500;
  color: #ffffff;
  background: rgba(0, 0, 0, 0.85);
  border-radius: var(--radius-xs);
  white-space: nowrap;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.15s ease, visibility 0.15s ease;
  pointer-events: none;
  margin-bottom: 4px;
  max-width: 200px;
  overflow: hidden;
  text-overflow: ellipsis;
  z-index: 102;
}

.element-overlay:hover .element-overlay__tooltip {
  opacity: 1;
  visibility: visible;
}

/* Toolbar builder mode button highlight */
.viewer-toolbar__button--builder-active {
  color: #3a61ff !important;
  background: rgba(58, 97, 255, 0.15);
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce) {
  .element-overlay,
  .element-overlay__tooltip {
    transition: none;
  }
}

/* v2-4-4: Active group — solid colored border (color set via inline style) */
.element-overlay--active-group {
  border-style: solid;
}

/* v2-4-4: Dimmed state — non-member elements when a group is selected */
.element-overlay--dimmed {
  opacity: 0.3;
  pointer-events: auto;
}

/* v2-4-4: Group item selected state */
.group-item--selected {
  cursor: pointer;
}

/* ========================================================================
   v2-4-3: Group Panel — right-side panel listing animation groups
   ======================================================================== */

.group-panel {
  position: fixed;
  top: 44px; /* Below toolbar */
  right: 0;
  bottom: 24px; /* Above status bar */
  width: 240px;
  background: var(--vscode-sideBar-background, #1e1e1e);
  border-left: 1px solid var(--vscode-panel-border, #333);
  display: flex;
  flex-direction: column;
  z-index: 110; /* Above animation-builder overlays (z-index: 100) */
  overflow-y: auto;
  pointer-events: auto;
}

/* AC-7: Responsive bottom sheet at <600px */
.group-panel--bottom-sheet {
  position: fixed;
  top: auto;
  bottom: 0;
  left: 0;
  right: 0;
  width: 100%;
  height: 200px;
  border-left: none;
  border-top: 1px solid var(--vscode-panel-border, #333);
}

.group-panel__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  border-bottom: 1px solid var(--vscode-panel-border, #333);
  flex-shrink: 0;
}

.group-panel__title {
  font-size: 13px;
  font-weight: 600;
  color: var(--vscode-foreground, #ccc);
  margin: 0;
}

.group-panel__count {
  font-size: 11px;
  color: var(--vscode-descriptionForeground, #888);
  background: var(--vscode-badge-background, #333);
  padding: 2px 8px;
  border-radius: 10px;
}

.group-panel__selection-count {
  font-size: 12px;
  color: var(--primary, #3a61ff);
  font-weight: 500;
}

/* Create Group section */
.group-panel__create-section {
  padding: 12px 16px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.group-panel__create-button {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  width: 100%;
  padding: 10px 16px;
  font-size: 13px;
  font-weight: 500;
  color: #ffffff;
  background: var(--primary, #3a61ff);
  border: none;
  border-radius: 4px;
  cursor: pointer;
  transition: background-color 0.15s ease, opacity 0.15s ease;
}

.group-panel__create-button:hover:not(:disabled) {
  background: var(--primary-hover, #4d73ff);
}

.group-panel__create-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.group-panel__create-button:focus-visible {
  outline: 2px solid var(--primary, #3a61ff);
  outline-offset: 2px;
}

.group-panel__hint {
  font-size: 11px;
  color: var(--vscode-descriptionForeground, #888);
  line-height: 1.5;
  margin: 0;
}

.group-panel__hint kbd {
  display: inline-block;
  padding: 2px 6px;
  font-size: 10px;
  font-family: inherit;
  background: var(--vscode-editor-background, #1e1e1e);
  border: 1px solid var(--vscode-panel-border, #333);
  border-radius: 3px;
  margin: 0 2px;
}

.group-panel__divider {
  height: 1px;
  background: var(--vscode-panel-border, #333);
  margin: 0;
}

.group-panel__section-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 16px;
}

.group-panel__section-title {
  font-size: 11px;
  font-weight: 600;
  color: var(--vscode-descriptionForeground, #888);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* AC-6: Empty state */
.group-panel__empty {
  padding: 24px 16px;
  font-size: 12px;
  color: var(--vscode-descriptionForeground, #888);
  text-align: center;
  line-height: 1.5;
}

.group-panel__list {
  flex: 1;
  overflow-y: auto;
  padding: 4px 0;
}

/* ========================================================================
   v2-4-3: Group Item — individual group row with drag handle
   ======================================================================== */

.group-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  cursor: default;
  transition: background 0.1s ease;
  user-select: none;
}

.group-item:hover {
  background: var(--vscode-list-hoverBackground, rgba(255, 255, 255, 0.05));
}

.group-item--dragging {
  opacity: 0.5;
  background: var(--vscode-list-activeSelectionBackground, rgba(58, 97, 255, 0.2));
}

.group-item__handle {
  cursor: grab;
  color: var(--vscode-descriptionForeground, #666);
  flex-shrink: 0;
  display: flex;
  align-items: center;
  padding: 4px;
  border-radius: 3px;
  transition: color 0.1s ease;
  touch-action: none;
}

.group-item__handle:hover {
  color: var(--vscode-foreground, #ccc);
  background: rgba(255, 255, 255, 0.05);
}

.group-item__handle:active {
  cursor: grabbing;
}

.group-item__badge {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 11px;
  font-weight: 700;
  color: #fff;
  flex-shrink: 0;
}

.group-item__info {
  flex: 1;
  min-width: 0;
}

.group-item__label {
  font-size: 12px;
  color: var(--vscode-foreground, #ccc);
  font-weight: 500;
}

.group-item__count {
  font-size: 11px;
  color: var(--vscode-descriptionForeground, #888);
}

.group-item__delete {
  background: none;
  border: none;
  color: var(--vscode-descriptionForeground, #666);
  cursor: pointer;
  padding: 4px;
  border-radius: 4px;
  display: flex;
  align-items: center;
  margin-left: auto;
  flex-shrink: 0;
}

.group-item__delete:hover {
  color: var(--vscode-errorForeground, #f44);
  background: var(--vscode-errorForeground-background, rgba(255, 68, 68, 0.1));
}

.group-item__delete:focus-visible {
  opacity: 1;
  outline: 1px solid var(--vscode-focusBorder, #3a61ff);
  outline-offset: -1px;
}

/* ========================================================================
   v2-4-3: Delete Confirmation Dialog (Radix UI)
   ======================================================================== */

.group-panel__dialog-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.5);
  z-index: 200;
}

.group-panel__dialog {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: var(--vscode-editorWidget-background, #252526);
  border: 1px solid var(--vscode-editorWidget-border, #454545);
  border-radius: 8px;
  padding: 24px;
  min-width: 320px;
  max-width: 400px;
  z-index: 201;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
}

.group-panel__dialog-title {
  font-size: 14px;
  font-weight: 600;
  color: var(--vscode-foreground, #ccc);
  margin: 0 0 8px 0;
}

.group-panel__dialog-description {
  font-size: 12px;
  color: var(--vscode-descriptionForeground, #888);
  margin: 0 0 20px 0;
  line-height: 1.5;
}

.group-panel__dialog-actions {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
}

.group-panel__dialog-cancel,
.group-panel__dialog-delete,
.group-panel__dialog-move {
  padding: 6px 16px;
  border-radius: 4px;
  font-size: 12px;
  cursor: pointer;
  border: none;
  font-weight: 500;
}

.group-panel__dialog-cancel {
  background: var(--vscode-button-secondaryBackground, #333);
  color: var(--vscode-button-secondaryForeground, #ccc);
}

.group-panel__dialog-cancel:hover {
  background: var(--vscode-button-secondaryHoverBackground, #444);
}

.group-panel__dialog-delete {
  background: var(--vscode-errorForeground, #f44);
  color: #fff;
}

.group-panel__dialog-delete:hover {
  opacity: 0.9;
}

/* v2-4-5: Move button styled as primary action */
.group-panel__dialog-move {
  background: var(--vscode-button-background, #0078d4);
  color: var(--vscode-button-foreground, #fff);
}

.group-panel__dialog-move:hover {
  background: var(--vscode-button-hoverBackground, #026ec1);
}

/* Reduced motion for group panel */
@media (prefers-reduced-motion: reduce) {
  .group-item,
  .group-item__delete {
    transition: none;
  }
}
